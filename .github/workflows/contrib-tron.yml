name: Generate Contrib Tron Animation

on:
  schedule:
    - cron: "0 12 * * *" # Daily at noon UTC
  workflow_dispatch: # Allows manual trigger
  push:
    branches: [ main ]

jobs:
  generate:
    runs-on: ubuntu-latest
    
    permissions:
      contents: write
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Create output directory
        run: mkdir -p output
      
      - name: Generate Contrib Tron animation (placeholder)
        run: |
          # Create a placeholder SVG animation
          cat > output/contrib-tron.svg << 'EOF'
          <svg width="740" height="200" xmlns="http://www.w3.org/2000/svg">
            <defs>
              <style>
                .bg { fill: #0d1117; }
                .title { fill: #00d4ff; font-family: Arial, sans-serif; font-size: 24px; font-weight: bold; }
                .subtitle { fill: #8b949e; font-family: Arial, sans-serif; font-size: 14px; }
                .cycle { fill: #00d4ff; }
                .trail { fill: #00ff88; opacity: 0.7; }
                .grid-cell { fill: #21262d; stroke: #30363d; stroke-width: 0.5; }
                
                .cycle-move {
                  animation: move 3s linear infinite;
                }
                
                @keyframes move {
                  0% { transform: translateX(0); }
                  100% { transform: translateX(200px); }
                }
              </style>
            </defs>
            
            <!-- Background -->
            <rect width="740" height="200" class="bg"/>
            
            <!-- Title -->
            <text x="370" y="30" text-anchor="middle" class="title">üèçÔ∏è Contrib Tron</text>
            <text x="370" y="50" text-anchor="middle" class="subtitle">AI Light Cycles Racing Through GitHub Contributions</text>
            
            <!-- Contribution Grid (simplified) -->
            <g transform="translate(50, 70)">
              <!-- Grid cells -->
              <rect x="0" y="0" width="8" height="8" class="grid-cell"/>
              <rect x="10" y="0" width="8" height="8" class="grid-cell"/>
              <rect x="20" y="0" width="8" height="8" class="grid-cell"/>
              <rect x="30" y="0" width="8" height="8" class="grid-cell"/>
              <rect x="40" y="0" width="8" height="8" class="grid-cell"/>
              
              <!-- Trail -->
              <rect x="0" y="0" width="8" height="8" class="trail"/>
              <rect x="10" y="0" width="8" height="8" class="trail"/>
              <rect x="20" y="0" width="8" height="8" class="trail"/>
              
              <!-- Moving cycle -->
              <rect x="30" y="0" width="8" height="8" class="cycle cycle-move"/>
            </g>
            
            <!-- Status -->
            <text x="370" y="180" text-anchor="middle" class="subtitle">Click "Play Interactive Version" below to play!</text>
          </svg>
          EOF
          
          # Create dark version
          sed 's/#0d1117/#161b22/g; s/#21262d/#30363d/g' output/contrib-tron.svg > output/contrib-tron-dark.svg
      
      - name: Commit and push
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add output/
          git diff --staged --quiet || git commit -m "Update Contrib Tron animation [skip ci]"
          git push