name: Update Profile README with Tron Game

on:
  schedule:
    - cron: '0 */6 * * *'  # Every 6 hours
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  update-readme:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4

    - name: Update README with Tron Game
      run: |
        # Get current timestamp
        TIMESTAMP=$(date '+%Y-%m-%d %H:%M UTC')
        
        # Create README with embedded game
        cat > README.md << 'EOF'
        # Hi there! üëã

        ## üèçÔ∏è Contrib Tron - AI Light Cycles Racing Through My GitHub Contributions

        <picture>
          <source media="(prefers-color-scheme: dark)" srcset="https://markpython86.github.io/markpython86-tron-github/game?mode=dark" />
          <source media="(prefers-color-scheme: light)" srcset="https://markpython86.github.io/markpython86-tron-github/game?mode=light" />
          <img alt="Tron GitHub Game - AI Light Cycles Racing" src="https://markpython86.github.io/markpython86-tron-github/game" />
        </picture>

        üéÆ Live auto-playing Tron game using my GitHub contribution data

        üèçÔ∏è [Click to Play Interactive Version](https://markpython86.github.io/markpython86-tron-github/)

        Last updated: TIMESTAMP_PLACEHOLDER
        EOF

        # Replace timestamp placeholder
        sed -i "s/TIMESTAMP_PLACEHOLDER/$TIMESTAMP/g" README.md

    - name: Commit and push changes
      run: |
        git config --local user.email "action@github.com"
        git config --local user.name "GitHub Action"
        git add README.md
        if git diff --staged --quiet; then
          echo "No changes to commit"
        else
          git commit -m "üèçÔ∏è Update Tron game display - $(date)"
          git push
        fi